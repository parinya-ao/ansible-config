# SPDX-License-Identifier: MIT-0
---
# Custom ports configuration using firewalld

- name: Open custom ports in firewalld
  ansible.posix.firewalld:
    port: "{{ item.port }}/{{ item.protocol | default('tcp') }}"
    permanent: true
    state: enabled
  loop: "{{ security_custom_ports }}"
  when: (item.state | default('enabled')) == 'enabled'
  become: true
  register: security_custom_ports_result
  notify: Firewalld reloaded
  tags:
    - firewalld
    - custom-ports

- name: Display custom ports rules
  ansible.builtin.debug:
    msg: "âœ“ Port {{ item.port }}/{{ item.protocol | default('tcp') }} is now {{ item.state | default('enabled') }}"
  loop: "{{ security_custom_ports }}"
  tags:
    - firewalld
    - custom-ports
