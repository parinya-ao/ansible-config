# SPDX-License-Identifier: MIT-0
---
# Install Brave browser

- name: Install DNF core plugins for Brave
  ansible.builtin.dnf:
    name: dnf-plugins-core
    state: present
  become: true

- name: Add Brave repository
  ansible.builtin.get_url:
    url: "{{ desktop_brave_repo_url }}"
    dest: /etc/yum.repos.d/brave-browser.repo
    owner: root
    group: root
    mode: "0644"
  become: true

- name: Import Brave GPG key
  ansible.builtin.rpm_key:
    state: present
    key: "{{ desktop_brave_gpg_key_url }}"
  become: true

- name: Install Brave browser
  ansible.builtin.dnf:
    name: brave-browser
    state: present
    update_cache: true
  become: true

- name: Fix Brave icon (copy to standard location)
  ansible.builtin.copy:
    src: /opt/brave.com/brave/product_logo_128.png
    dest: /usr/share/icons/hicolor/128x128/apps/brave-browser.png
    remote_src: true
    owner: root
    group: root
    mode: "0644"
  become: true
  register: desktop_icon_injected
  notify: Refresh icon cache, Update desktop database

- name: Display Brave installation complete
  ansible.builtin.debug:
    msg: "Brave browser installed successfully."
